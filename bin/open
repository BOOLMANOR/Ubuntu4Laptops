#!/usr/bin/python
# smart open command (mac-like) for GNU/Linux (c) syscl
# To use it copy it to /usr/local/bin
import sys
import os
import platform
import subprocess

# define errors
kArgvMissing = -1

if len(sys.argv) <= 1:
    print("Usage: open [filesnames]")
    print("Help: Open opens files from a shell.")
    print("      By default, opens each file using the default application for that file.")
    print("      If the file is in the form of a URL, the file will be opened as a URL.") 
    exit(kArgvMissing)

# starting from index one to end
# note: shell paraphases "~" into "/home/[username]" 
for path in sys.argv[1:]:
    is_link = path.find("http://") == 0 or path.find("https://") == 0 or path.find("ftp://") == 0
    if path[0] == '~' or path[0] == '/' or is_link:
        # TODO: remove invalid input e.g. "~~"
        pass
    else: 
        # correct it with current working directory use
        path = os.getcwd() + "/" + path

    if not is_link and not os.path.exists(path):
        print("The file " + path + " does not exist.")
        continue

    subprocess.call(["xdg-open", path], stdout=open(os.devnull, "w"), stderr=subprocess.STDOUT)

exit()